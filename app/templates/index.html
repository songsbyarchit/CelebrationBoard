{% extends "base.html" %}
{% block content %}
<div class="posts">
    <h1>Recent Celebrations</h1>

    {% if posts %}
    {% for post in posts %}
    <div class="post-card">
        <h2>{{ post.title }}</h2>
        <div class="post-info">
            <span>Posted by {{ post.author.username }}</span>
            <span>{{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</span>

            {% if post.author == current_user %}
            <div class="post-actions">
                <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn-edit">Edit</a>
                <form action="{{ url_for('delete_post', post_id=post.id) }}" method="POST" class="delete-form">
                    <button type="submit" class="btn-delete"
                        onclick="return confirm('Are you sure you want to delete this post?');">Delete</button>
                </form>
            </div>
            {% endif %}
        </div>
        <div class="post-content">
            {{ post.content }}
        </div>
        {% if post.file_filename %}
        <div class="post-attachment">
            {% if post.file_filename.lower().endswith(('.png', '.jpg', '.jpeg', '.gif')) %}
            <img src="{{ url_for('static', filename='uploads/' + post.file_filename) }}" alt="Celebration Image"
                class="post-image">
            {% else %}
            <a href="{{ url_for('static', filename='uploads/' + post.file_filename) }}" download>
                <i class="file-icon">ðŸ“Ž</i> Download {{ post.file_filename }}
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <p>No celebrations posted yet. Be the first to share one!</p>
    {% endif %}
</div>
{% endblock %}